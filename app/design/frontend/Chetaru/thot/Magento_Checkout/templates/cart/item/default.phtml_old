<?php

/**
 * Copyright Â© 2016 Magento. All rights reserved.
 * See COPYING.txt for license details.
 */

// @codingStandardsIgnoreFile

/** @var $block \Magento\Checkout\Block\Cart\Item\Renderer */

$_item = $block->getItem();
$product = $_item->getProduct();
$isVisibleProduct = $product->isVisibleInSiteVisibility();
/** @var \Magento\Msrp\Helper\Data $helper */
$helper = $this->helper('Magento\Msrp\Helper\Data');
$canApplyMsrp = $helper->isShowBeforeOrderConfirm($product) && $helper->isMinimalPriceLessMsrp($product);
?>
<div class="col-sm-12">
	<div class="cart-item-block cart-item-block-gk">
		<div class="col-md-5">
			<div class="row">
				<?php
				//echo $block->getImage($block->getProductForThumbnail(), 'cart_page_product_thumbnail')->toHtml();
				//$productImage = $block->getImage($product, 'hot_product_page_image_medium'); 
				//$productImage = $block->getImage($product, 'cart_page_product_thumbnail');
				
				$thumbnailUrl = $block->getUrl() . "pub/media/catalog/product/". $product->getThumbnail();

 ?>

				<img src="<?php /* @escapeNotVerified */ echo $thumbnailUrl; //echo $productImage->getImageUrl(); ?>" class="img-responsive img-responsive-gk">
			</div>
		</div>

		<div class="col-md-7 cart-item-info">
			<div class="">
				<h3>
					<?php if ($block->hasProductUrl()) : ?>
						<a href="<?php /* @escapeNotVerified */ echo $block->getProductUrl() ?>"><?php echo $block->escapeHtml($block->getProductName()) ?></a>
					<?php else : ?>
						<?php echo $block->escapeHtml($block->getProductName()) ?>
					<?php endif; ?>
				</h3>
				<?php
				$product_id = $product->getId();

				$objectManager = \Magento\Framework\App\ObjectManager::getInstance();
				$storeManager = $objectManager->get('Magento\Store\Model\StoreManagerInterface');
				$currentStore = $storeManager->getStore();
				$store_url = $currentStore->getBaseUrl();
				$resource = $objectManager->get('Magento\Framework\App\ResourceConnection');
				$connection = $resource->getConnection();
				$tableName = $resource->getTableName('ves_brand_product');
				$sql = "SELECT brand_id FROM " . $tableName . " WHERE product_id=" . $product_id;
				$results = $connection->fetchAll($sql);

				if (!empty($results)) {
					$brand_ids = array();
					foreach ($results as $result) {
						array_push($brand_ids, $result['brand_id']);
					}
					$tableName = $resource->getTableName('ves_brand');
					$sql = "SELECT * FROM " . $tableName . " WHERE brand_id IN (" . implode(",", $brand_ids) . ")";
					$brands = $connection->fetchAll($sql);

					$tableName = $resource->getTableName('core_config_data');
					$sql = "SELECT value FROM " . $tableName . " WHERE path='vesbrand/general_settings/url_prefix'";
					$url_prefix = $connection->fetchAll($sql);

					$sql = "SELECT value FROM " . $tableName . " WHERE path='vesbrand/general_settings/url_suffix'";
					$url_suffix = $connection->fetchAll($sql);

				?>
					<h4>
						By
					<?php
					foreach ($brands as $i => $brand) {
						echo '<a href=' . $store_url . $url_prefix[0]['value'] . "/" . $brand['url_key'] . $url_suffix[0]['value'] . '><span>' . $brand['name'] . '</span></a>';
						if (count($brands) > 1 && $i < count($brands) && $i < count($brands) - 1) echo ', ';
					}
				}
					?>
			</div>
			<div class="product-price" data-th="<?php echo $block->escapeHtml(__('Price')); ?>">
				<?php echo $block->getUnitPriceHtml($_item); ?>
			</div>
			<div class="btn-group col-md-4">
				<div class="row qnty_wrap ">
					<h4 class="btn-head2" data-th="<?php echo $block->escapeHtml(__('Qty')); ?>">Qty:</h4>
					<div class="qty-wrapper">
						<button class="decrement" onclick="changeQty(-1, '<?php echo $_item->getId(); ?>')">-</button>
						<input id="cart-<?php echo $_item->getId(); ?>-qty" name="cart[<?php echo $_item->getId(); ?>][qty]" data-cart-item-id="<?php echo $_item->getSku(); ?>" value="<?php echo $block->getQty(); ?>" type="number" size="4" title="<?php echo $block->escapeHtml(__('Qty')); ?>" class="input-text qty" maxlength="12" data-validate="{required:true,'validate-greater-than-zero':true}" id="fdsfd" data-role="cart-item-qty" />
						<button class="increment" onclick="changeQty(1, '<?php echo $_item->getId(); ?>')">+</button>
					</div>
				</div>
			</div>

			<div class="color-options">
				<?php if ($_options = $block->getOptionList()) : ?>
					<ul class="item-options">
						<?php foreach ($_options as $_option) : ?>
							<?php $_formatedOptionValue = $block->getFormatedOptionValue($_option) ?>
							<li>
								<div class="color-label"><?php echo $block->escapeHtml($_option['label']) ?>:</div>
								<div class="detAtt">
									<?php if (isset($_formatedOptionValue['full_view'])) : ?>
										<?php /* @escapeNotVerified */ echo $_formatedOptionValue['full_view'] ?>
									<?php else : ?>
										<?php /* @escapeNotVerified */ echo $_formatedOptionValue['value'] ?>
									<?php endif; ?>
								</div>
							</li>
						<?php endforeach; ?>
					</ul>
				<?php endif; ?>


				<div class="clearfix"></div>
				<?php if ($messages = $block->getMessages()) : ?>
					<?php foreach ($messages as $message) : ?>
						<div class="cart item message <?= $block->escapeHtmlAttr($message['type']) ?>">
							<div><?= $block->escapeHtml($message['text']) ?></div>
						</div>
					<?php endforeach; ?>
				<?php endif; ?>
				<?php $addInfoBlock = $block->getProductAdditionalInformationBlock(); ?>
				<?php if ($addInfoBlock) : ?>
					<?= $addInfoBlock->setItem($_item)->toHtml() ?>
				<?php endif; ?>
			</div>

			<div class="btnGiftOptions btnGiftOptionswrap">
				<?php /* @escapeNotVerified */ echo $block->getActions($_item) ?>
			</div>
			<div class="clearfix"></div>

		</div>


	</div>
</div>
<script>
	function changeQty(value, itemId) {
		var inputElement = document.getElementById('cart-' + itemId + '-qty');
		var currentValue = parseInt(inputElement.value) || 0;
		var newValue = currentValue + value;

		if (newValue >= 1) {
			inputElement.value = newValue;
		}
	}
</script>
<style>
	.color-label {
		margin: 3px 0 0 0 !important;
		font-weight: 500;
		font-size: 13px !important;
		text-transform: uppercase;
		color: #000;
		margin-right: 10px !important;
	}

	.color-options {
		clear: both;
	}

	.color-options ul li {
		display: flex;
	}

	form.form.form-cart .col-md-7.cart-item-info .btnGiftOptions {
		position: static;
	}

	.cart-item-info .btnGiftOptions a.action-delete {
		position: absolute !important;
		top: 30px;
		right: 30px;
		z-index: 9;
	}

	#shopping-cart-table .cart-item-info {
		padding-right: 30px !important;
	}

	#shopping-cart-table .cart-item-info .product-price {
		width: 100%;
	}

	#shopping-cart-table .cart-item-info h4 {
		margin-bottom: 0px !important;
	}

	#shopping-cart-table .cart-item-info .product-price .price-including-tax {
		margin-top: 0px;
		border-bottom: 1px dotted #eee;
		padding-bottom: 12px;
	}

	#shopping-cart-table .cart-item-info h3 {
		margin-bottom: 10px !important;
	}
</style>